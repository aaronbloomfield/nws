<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8"><base target="_blank">
    <title>Network Security slide set</title>
    <meta name="description" content="A set of slides for a course on Introduction to Cybersecurity">
    <meta name="author" content="Aaron Bloomfield">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
    <link rel="stylesheet" href="../slides/reveal.js/dist/reset.css">
    <link rel="stylesheet" href="../slides/reveal.js/dist/reveal.css">
    <link rel="stylesheet" href="../slides/reveal.js/dist/theme/black.css" id="theme">
    <link rel="stylesheet" href="../slides/nws.css">
    <!-- Code syntax highlighting -->
    <link rel="stylesheet" href="../slides/reveal.js/plugin/highlight/zenburn.css">
    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? '../slides/reveal.js/css/print/pdf.scss' : '../slides/reveal.js/css/print/paper.scss';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>
    <!--[if lt IE 9]>
	<script src="../slides/reveal.js/lib/js/html5shiv.js"></script>
	<![endif]-->
  </head>

  <body>
    <div class="reveal">
      <div class="slides">

<section data-markdown id="cover"><script type="text/template">
# CS 4760
&nbsp;  
### Network Security

<p class='titlep'>&nbsp;</p>
<div class="titlesmall"><p>
<a href="http://www.cs.virginia.edu/~asb">Aaron Bloomfield</a> (aaron@virginia.edu)<br>
<a href="http://github.com/aaronbloomfield/nws">@github</a> | <a href="index.html">&uarr;</a> | <a href="?print-pdf"><img class="print" width="20" src="../slides/images/print-icon.webp" style="top:0px;vertical-align:middle"></a>
</p></div>
<p class='titlep'>&nbsp;</p>

## Network Malware
</script></section>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

<section data-markdown><textarea data-template>
# Contents
&nbsp;  
[Bots and Botnets](#/bots)  
[Ransomware](#/ransomware)  
[Rootkits](#/rootkits)  
[Trojans](#/trojans)  
[Worms](#/worms)  
</textarea></section>
  
<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

<section>

<section data-markdown id="bots" class="center"><textarea data-template>
# Bots and Botnets
</textarea></section>
    
<section data-markdown data-separator="^\n\n\n"><textarea data-template>
## Bot
- Bot: a piece of software that performs automated tasks, imitating a human
- Examples and uses:
  - Web crawlers
  - Reddit auto-posters
  - Conversation with actual humans
  - Increase trading positions
  - Add reviews to a product
- And, of course, for malicious purposes
  - Often called a zombie computer in this context



<!-- .slide: class="right-float-img-1000" -->
## Typically installed on

<img src="https://imgs.xkcd.com/comics/smart_home_security.png" title="If they&#39;re getting valuable enough stuff from you, at least the organized crime folks have an incentive to issue regular updates to keep the appliance working after the manufacturer discontinues support." alt="Smart Home Security" srcset="https://imgs.xkcd.com/comics/smart_home_security_2x.png 2x" style="image-orientation:none" class='stretch'>

- Computers
- Phones
- IoT devices, as in [xkcd # 1966](http://xkcd.com/1966/)
  - This is the big one!



<!-- .slide: class="right-float-img-600" -->
## Botnet

<a href='https://commons.wikimedia.org/wiki/File:Stachledraht_DDos_Attack.svg'><img src='https://upload.wikimedia.org/wikipedia/commons/3/3f/Stachledraht_DDos_Attack.svg' style="max-height:unset;height:500px"></a>

- A collection of Internet connected bots
- Typically performs a negative function
  - Stealing data
  - Denial of service attacks
- Renting



## Bot installation
- Via malware:
  - Trojans
  - Worms
  - Viruses (maybe)
- Phishing scams
- Logins with weak passwords (Morris Worm)
- Malicious web pages running in insecure browsers



## Botnet control
- Once you have the bots, they have to *listen* for commands "somewhere"
  - The bots also post their results back to that same "somewhere"
- This is called command and control (C&C)



<!-- .slide: class="right-float-img-600" -->
## Botnet control: Client-server

<a href='https://en.wikipedia.org/wiki/File:Server-based-network.svg'><img src='https://upload.wikimedia.org/wikipedia/commons/f/fb/Server-based-network.svg' style="width:350px"></a>

- Botmaster has control of one or more servers
  - Perhaps a website, perhaps a full machine
  - Could also be a centralized newsgroup, forum, channel, etc.
- Commands for the bot network are posted there
- Defense: block the IP address(es) in the router
  - And add a Snort rule!



## Botnet control: IRC (etc.)
- Internet Relay Chat is a distributed messaging system
- Botmaster creates a channel
  - Each bot "checks in" to that channel
- Commands for the bots are put there
  - Bots also post their results
- This is a form of client-server
  - The IRC channel is the "server"
- Defense: these channels can be taken down



<!-- .slide: class="right-float-img-600" -->
## Botnet control: Peer-to-peer

<a href='https://en.wikipedia.org/wiki/File:P2P-network.svg'><img src='https://upload.wikimedia.org/wikipedia/commons/3/3f/P2P-network.svg' style="width:350px"></a>

- Each bot opens a given port on the machine
  - Or maybe a random port
- A bot will then then try random IP addresses
  - And maybe random ports
- Until it finds another infected machine to make its peer
- Advantages is that it avoids a single point of failure
- Modern botnets use this



## Blocking P2P bots
- This is much harder
  - A lot of legitimate traffic is P2P
  - And a bot's traffic can be disguised as legitimate traffic




<!-- .slide: class="right-float-img-600 no-border" -->
## Honeypots
[![](https://upload.wikimedia.org/wikipedia/commons/thumb/2/25/Old_Honey_Pot_%286740954363%29.jpg/406px-Old_Honey_Pot_%286740954363%29.jpg)](https://commons.wikimedia.org/wiki/File:Old_Honey_Pot_(6740954363).jpg)
- A known installation on a machine that looks vulnerable to outside agents
  - Open ports, etc.
- If infected, one can study what the infection did
  - Both it's effect on the computer
  - And via a .pcap of the network traffic
- If attacked...
  - One can study the attack mechanism
  - And block that IP from contacting your network



## Case study: Mirai botnet
- In 2016, it logged in to IoT devices with the default username and password
  - Scanned for port 23, and attempted to login
  - If successful, downloaded botnet code to device
- At it's peak, controlled 350k devices
- Source code online at https://github.com/jgamblin/Mirai-Source-Code
- Used the client-server model
  - The ISP of the server was contacted, and took that IP offline...
  - ... but Mirai got that IP from a URL, so it just changed over to a different server
- The URL was harder to take down, and this botnet persisted for *months*



## Case study: Storm worm botnet
- Researchers infiltrated and monitored the [Storm worm](https://en.wikipedia.org/wiki/Storm_Worm) (and botnet) in 2007
  - After 26 days, and 350M e-mails, only 28 sales resulted (mostly for male enhancement)
    - Average price: $100
  - Profits were estimated at $2,731.88
  - Just over $100 per day
  - This was with 1.5% of the Storm botnet
  - Extrapolating, that's about $7,000 per day with the entire Storm botnet, if you could utilize all that capacity
</textarea></section>

</section>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

<section>

<section data-markdown id="ransomware" class="center"><textarea data-template>
# Ransomware
</textarea></section>
    
<section data-markdown data-separator="^\n\n\n"><textarea data-template>
## Ransomware
- Malicious software that "locks" the computer, and only unlocks it when payment is made
  - Locking is typically through encrypting the files
    - Thus also called *cryptoviral extortion*
  - Payment is typically through cryptocurrency
- Typically distributed by a Trojan
  - But some have been known to propagate via a worm



## Defense: tracing
- If your machine suffered a ransomware attack, you might:
  - Analyze the executable to see the encryption algorithm used
  - Review the network packets to see if the key is visible therein
  - Perform more analysis to determine the key used for the encryption
  - Then decrypt your files
- If that were the case, ransomware would never be effective
- So the cryptographic keys can't be kept on the computer



## Ransomware key management
- The released ransomware has a public key of the attacker
- The ransomware generates a random key
  - Files are encrypted using a modern symmetric encryption algorithm (AES, for example)
- The key is encrypted with the attacker's public key
  - This is the RSA encrypted AES decryption key
  - It is then erased entirely from the machine
- Now no key exists on the victim computer



## Ransomware ransom
- The victim pays the ransom
  - Usually via cryptocurrency, since that's not very traceable
- And also sends the RSA encrypted AES decryption key to the attacker
- The attacker can decrypt that key
  - And *might* return it once the ransom is paid
  - But usually does -- otherwise no future victims will pay



## Leakware / Doxware
- Rather than extortion for payment, this is extortion to not release the files
- Imagine a health system had its data exfiltrated
- A ransom demand could be made to not release this data publicly
- Types of information used in these attacks:
  - 3rd party information (bank accounts, health data)
  - Proprietary information (trade secrets, product information)
  - Embarrassing information (health info, browsing history)



## Mobile ransomware
- Target is not file encryption
  - Since most devices have backups in the cloud
- Instead, it locks the phone
  - And unlocks it when the ransom is paid
- More often happens with Android devices
  - As Android allows installation from 3rd party sources
  - It happens on iOS, just much less



## Case Study: WannaCry
- Used an exploit in MS Windows, demanded payment in Bitcoin
- Effected 300k machines
  - With damages estimated from "hundreds of millions to billions" of US dollars
- It used the EternalBlue exploit
  - Developed by the NSA
  - And released to the public by [The Shadow Brokers](https://en.wikipedia.org/wiki/The_Shadow_Brokers), who obtained many of the NSA's cyberweapons in 2016



<h2 class="r-fit-text">Case Study: <a href='https://en.wikipedia.org/wiki/2019_Baltimore_ransomware_attack'>2019 Baltimore attack</a></h2>

- A use of the Robbinhood Ransomware
- Why was Baltimore susceptible?
  - Decentralized control of IT budget
  - Insufficient finding for information security
- Effects: multiple municipal services down for *months*, including databases and applications
- It is speculated that it also used EternalBlue
- Ransom demand: demanded 13 bitcoin (about $76k then)
- Baltimore refused to pay, and had to spend 4 months, and $18 *million*, to recover



<!-- .slide: class="right-float-img-400 no-border" -->
## Case study: Petya & NotPetya
[![](https://upload.wikimedia.org/wikipedia/commons/6/65/2017_Petya_cyberattack_screenshot.png)](https://commons.wikimedia.org/wiki/File:2017_Petya_cyberattack_screenshot.png)
- Infected Ukrainian companies through a back door put into a Ukrainian version of a TurboTax-like software
  - Companies with Ukrainian subsidiaries were infected through their corporate network
- This was "the equivalent of using a nuclear bomb to achieve a small tactical victory"
- There is a good [Wired article](https://www.wired.com/story/notpetya-cyberattack-ukraine-russia-code-crashed-the-world/) on it
- It has been speculated that, due to the increases in cybersecurity in Ukraine from this, the defenses were more sound during the Russian invasion
</textarea></section>

</section>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

<section>

<section data-markdown id="rootkits" class="center"><textarea data-template>
# Rootkits
</textarea></section>
    
<section data-markdown data-separator="^\n\n\n"><textarea data-template>

## Review: rootkits
- A *rootkit* is an exploit that permits an attacker to execute commands with root privileges
  - i.e. as root on Linux or as Administrator on Windows
  - It does this *while hiding the activity to avoid detection* by system administrators
- To hide from a system administrator on a Unix system, the attacker would want to suppress displays of attacker processes, attacker files, attacker logins, etc.
  - Several utilities (e.g. ps, ls, users) would need to be replaced with versions that will hide files, logins, and processes
- Goal is likely one of: ransomware, data exfiltration, or a bot in a botnet



## Review: Kernel Level Rootkits
- A kernel level rootkit adds to, or modifies, the OS kernel code to patch or hook system calls, so that the Trojan Horse version hides info about the attacker
  - Often done in Linux with a Loadable Kernel Module
  - Windows equivalent is usually a loadable device driver



<h2 class="r-fit-text">Review: Application Level Rootkits</h2>

- Application level rootkits patch or replace a significant application with a Trojan Horse version
  - Easier than kernel level to do; also easier to detect
- Often a lot of system applications are replaced
  - ls, ps, users, who, etc.



## Review: Detecting Rootkits
- Major problem: The OS is not trustworthy during the scanning process, if there is a kernel mode rootkit present
- Most reliable solution: Shut down system, scan the hard drive from an external connection, with no OS running
- How often do users want to do this???
  - Need scanners similar to antivirus scanners



<!-- .slide: class="small-pre wide-pre" -->
## Network security and rootkits
- Networks are often the means by which a rootkit is downloaded
  - With proper monitoring, this can be detected
- Rootkits have non-standard behavior, and network analysis can sometimes detect this:
```
alert tcp $EXTERNAL_NET any -> $TELNET_SERVERS 23 (
    msg:"BACKDOOR MISC Linux rootkit attempt"; flow:to_server,established; 
    content:"wh00t!"; classtype:attempted-admin; sid:213; rev:4;)
```
- Also, high outbound traffic is suspicious, and could be a rootkit or zombie
</textarea></section>

</section>
  
<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

<section>

<section data-markdown id="trojans" class="center"><textarea data-template>
# Trojans
</textarea></section>
    
<section data-markdown data-separator="^\n\n\n"><textarea data-template>
## End of prepared slides
</textarea></section>

</section>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

<section>

<section data-markdown id="wornms" class="center"><textarea data-template>
# Worms
</textarea></section>
    
<section data-markdown data-separator="^\n\n\n"><textarea data-template>
## ...
</textarea></section>

</section>
  
<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
	
</div>
</div>
<script src="../slides/reveal.js/dist/reveal.js"></script>
<script src="../slides/reveal.js/plugin/zoom/zoom.js"></script>
<script src="../slides/reveal.js/plugin/notes/notes.js"></script>
<script src="../slides/reveal.js/plugin/search/search.js"></script>
<script src="../slides/reveal.js/plugin/markdown/markdown.js"></script>
<script src="../slides/reveal.js/plugin/highlight/highlight.js"></script>
<script src="../slides/reveal.js/plugin/math/math.js"></script>
<script src="settings.js"></script>
</body>
</html>
